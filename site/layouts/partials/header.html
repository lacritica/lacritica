<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {{ $.Scratch.Set "Title" (default .Title (index .Site.Params.text (print "title_" (lower .Title)))) }}
    <title>
      {{ if eq ($.Scratch.Get "Title") .Site.Title }}
        {{ .Site.Title }}
      {{ else }}
        {{ ($.Scratch.Get "Title") }} | {{ .Site.Title }}
      {{ end }}
    </title>
    <link rel="stylesheet" href="{{ "css/style.css" | relURL }}" />
    <link rel="stylesheet" href="{{ "css/fonts.css" | relURL }}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.1.0/css/all.min.css">
    <!-- Your custom overrides should be last -->
    <link rel="stylesheet" href="{{ "css/custom.css" | relURL }}" />
    {{ partial "head_custom.html" . }}
  </head>

  <body{{ if .IsPage }} class="page"{{ end }}>
<nav class="header">
  <div class="banner">
    <a href="{{ "/" | relURL }}" class="logo-link">
      {{ partial "logo.svg" . }}
    </a>
  </div>
</nav>

<div class="taxonomy-bar">
  {{ with .Site.Taxonomies.categories }}
    <ul>
      {{ range $key, $value := . }}
        <li>
          <a href="{{ "/categories/" | relURL }}{{ $key | urlize }}">{{ $key }}</a>
        </li>
      {{ end }}
    <!-- Hamburger button -->
    <!-- Hamburger button -->
    <!-- Hamburger button -->
<button id="menu-toggle" aria-label="Toggle menu">
  <img src="{{ "img/three_lines.svg" | relURL }}" alt="Menu toggle icon" class="menu-icon">
</button>

<!-- Collapsible menu -->
<nav id="menu" class="hidden">
  <button id="menu-close" aria-label="Close menu">✕</button>
  <ul>
    <input type="text" id="search-box" placeholder="Search...">
    <li><ul id="search-results"></ul></li>
    <li><a href="/quienes_somos/">quienes somos</a></li>
    <li><a href="/contáctenos/">contáctenos</a></li>
    <li><a href="/page3">Page 3</a></li>
  </ul>
</nav>
    <!-- Hamburger button -->
    <!-- Hamburger button -->
    <!-- Hamburger button -->

  {{ end }}
</div>

    </nav>
    
    <script src="https://cdn.jsdelivr.net/npm/flexsearch@latest/dist/flexsearch.bundle.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flexsearch@latest/dist/flexsearch.bundle.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const btn = document.getElementById("menu-toggle");
  const menu = document.getElementById("menu");
  const closeBtn = document.getElementById("menu-close");
  const searchBox = document.getElementById("search-box");
  const searchResults = document.getElementById("search-results");

  // Menu toggle
  btn.addEventListener("click", (e) => {
    e.stopPropagation();
    menu.classList.toggle("show");
    btn.classList.toggle("hide");
  });

  menu.addEventListener("click", (e) => {
    e.stopPropagation();
  });

  document.addEventListener("click", () => {
    if (menu.classList.contains("show")) {
      menu.classList.remove("show");
      btn.classList.remove("hide");
    }
  });

  closeBtn.addEventListener("click", () => {
    menu.classList.remove("show");
    btn.classList.remove("hide");
  });

  // FlexSearch setup
  const index = new FlexSearch.Document({
    document: {
      id: "url",
      index: ["title", "content"],
      store: ["title", "url"]
    }
  });

  fetch("/index.json")
    .then(res => res.json())
    .then(data => {
      data.forEach(page => index.add(page));
    });

  // Search input listener
  searchBox.addEventListener("input", async (e) => {
    const query = e.target.value;
    const results = await index.searchAsync(query, { enrich: true });

    searchResults.innerHTML = "";

    results.forEach(group => {
      group.result.forEach(item => {
        const li = document.createElement("li");
        li.innerHTML = `<a href="${item.url}">${item.title}</a>`;
        searchResults.appendChild(li);
      });
    });
  });
});
</script>

  </body>
</html>
